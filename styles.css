/* --- Theme variables --- */
:root {
  --bg: #ffffff;
  --panel: #f4f4f4;
  --text: #000000;
  --muted: #666;
  --accent-1: #00506A;
  /* Atlantic */
  --accent-2: #730051;
  /* Lupine */
  --accent-3: #955021;
  /* Bark */
  --accent-4: #9B2822;
  /* Brick */
  --accent-5: #1D5C57;
  /* Spruce */
  --accent-6: #687C2F;
  /* Pine */
  --glass: rgba(0, 0, 0, 0.06);
  --transition: 300ms cubic-bezier(.2, .9, .3, 1);
  --code-bg: #ffffff;
  /* subtle, will use a soft border for contrast */
  --shadow: 0 12px 40px rgba(10, 10, 20, 0.06);
  --ui-font: 'Mr Eaves XL Sans', Arial, sans-serif;
  --mono-font: 'Ubuntu Mono', 'Courier New', monospace;
  /* gradient tokens for bubbles (tweakable) */
  --user-grad: linear-gradient(90deg, #b84a24, #8f3b1a);
  --user-grad-dark: linear-gradient(90deg, #a14a2a, #7b361f);
  --ai-grad: linear-gradient(90deg, #006b84, #1f6f63);
  --ai-grad-dark: linear-gradient(90deg, #0a859f, #1b7b6d);
  /* flat colors for diamond tails and flat bubble fills */
  --user-color: #8f3b1a;
  --user-color-dark: #8f3b1a;
  --ai-color: #006b84;
  --ai-color-dark: #0a859f;
}

.dark {
  --bg: #050608;
  --panel: #0f1724;
  --text: #e6eef0;
  --muted: #bcd0d6;
  --glass: rgba(255, 255, 255, 0.08);
  --code-bg: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
  --shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
}

* {
  box-sizing: border-box
}

html,
body {
  -webkit-text-size-adjust: 100%;
  height: 100%
}

body {
  margin: 0;
  font-family: var(--ui-font);
  background: var(--bg);
  color: var(--text);
  transition: background var(--transition), color var(--transition);
}

.visually-hidden {
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px, 1px, 1px, 1px);
  white-space: nowrap;
  border: 0;
  padding: 0;
  margin: -1px
}

.container {
  max-width: 1200px;
  margin: 18px auto;
  padding: 12px 18px;
  display: grid;
  grid-template-columns: 1fr 420px;
  grid-template-rows: auto 1fr auto;
  gap: 8px;
  align-items: start
}

header {
  grid-column: 1/-1;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 6px 4px
}

.brand {
  display: flex;
  align-items: center;
  gap: 12px
}

.site-header-wordmark {
  background-color: #000;
  background-position: center;
  background-repeat: no-repeat;
  background-size: 120px 24px;
  background-image: url(https://www.bowdoin.edu/_files/img/wordmark-long.png);
  margin-right: auto;
  width: 136px;
  height: 36px;
  box-sizing: inherit;
}

.logo {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 700;
  font-family: var(--mono-font);
  box-shadow: none
}

h1 {
  font-size: 16px;
  margin: 0
}

p.tag {
  margin: 0;
  color: var(--muted);
  font-size: 12px
}

.top-controls {
  display: flex;
  align-items: center;
  gap: 12px
}

.theme-toggle {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.8), rgba(247, 247, 249, 0.95));
  border: 1px solid rgba(16, 24, 32, 0.06);
  padding: 6px;
  border-radius: 10px;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all var(--transition);
  box-shadow: 0 6px 18px rgba(10, 10, 20, 0.04)
}

.dark .theme-toggle {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
  border: 1px solid rgba(255, 255, 255, 0.06);
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.6)
}

.theme-toggle:hover {
  transform: translateY(-2px)
}

.theme-toggle svg {
  width: 18px;
  height: 18px
}

.theme-toggle svg {
  color: var(--muted)
}

.dark .theme-toggle svg {
  color: #ffffff
}

.frame {
  grid-column: 1/-1;
  display: grid;
  grid-template-columns: 1fr 420px;
  gap: 12px;
  background: var(--panel);
  border-radius: 12px;
  padding: 10px;
  box-shadow: var(--shadow);
  align-items: start;
  position: relative;
}

/* height is computed at runtime to match the editor */
.editor,
.agent {
  background: transparent;
  border-radius: 8px;
  padding: 12px;
  box-shadow: none;
  height: 100%
}

.editor .meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px
}

.file-tabs {
  display: flex;
  gap: 8px
}

.tab {
  padding: 6px 8px;
  border-radius: 8px;
  font-size: 12px;
  background: transparent;
  border: 1px solid transparent
}

.tab.active {
  background: linear-gradient(90deg, rgba(0, 0, 0, 0.04), rgba(0, 0, 0, 0.02));
  border-color: var(--glass)
}

pre.code {
  margin: 0;
  overflow: auto;
  border-radius: 8px;
  padding: 14px 8px 28px;
  background: var(--code-bg);
  font-family: var(--mono-font);
  font-size: clamp(12px, 1.2vw, 14px);
  line-height: 1.25;
  color: var(--text);
  min-height: 220px;
  border: 1px solid rgba(10, 10, 20, 0.04);
  white-space: pre;
  overflow-x: auto;
  overflow-y: auto
}

.dark pre.code {
  border: 1px solid rgba(255, 255, 255, 0.04);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.0))
}

ol.lines {
  counter-reset: linenumber;
  margin: 0;
  padding: 0 0 0 24px;
  list-style: none
}

ol.lines li {
  position: relative;
  padding: 0 8px 0 0;
  white-space: pre;
  padding-right: 12px;
  overflow-wrap: normal
}

ol.lines li:before {
  counter-increment: linenumber;
  content: counter(linenumber);
  position: absolute;
  left: -52px;
  width: 44px;
  text-align: right;
  padding-right: 8px;
  color: var(--muted);
  font-family: var(--mono-font);
  font-size: clamp(12px, 1vw, 14px)
}

.tok-key {
  color: #007b95;
}

/* Atlantic - a touch brighter */
.tok-str {
  color: #7a0b57;
}

/* Lupine - deep magenta */
.tok-num {
  color: #b04a2b;
}

/* Brick/Bark */
.tok-bool {
  color: #1f6f63;
}

/* Spruce */
.tok-null {
  color: #9a5b3a;
}

/* Bark */
.tok-comment {
  color: #74858a;
  font-style: italic
}

.dark .tok-key {
  color: #6fd0ea
}

.dark .tok-str {
  color: #f09be0
}

.dark .tok-num {
  color: #f6b08a
}

.dark .tok-bool {
  color: #9fe0cc
}

.dark .tok-null {
  color: #d19a6a
}

.dark .tok-comment {
  color: #9aaeb2;
  font-style: italic
}

.caret {
  display: inline-block;
  width: 6px;
  height: 1em;
  min-height: 12px;
  background: var(--accent-4);
  vertical-align: middle;
  transform-origin: center;
  animation: caret-blink 1s steps(1, end) infinite;
  box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.08);
}

.dark .caret {
  background: var(--accent-1);
}

@keyframes caret-blink {
  0% {
    opacity: 1
  }

  50% {
    opacity: 0
  }

  100% {
    opacity: 1
  }
}

/* Links inside the code preview (strings, countdown, registration links) */
pre.code a,
pre.code a:link,
pre.code a:visited {
  color: inherit;
  text-decoration: underline;
  text-underline-offset: 3px;
  opacity: 0.95;
  cursor: pointer;
}
pre.code a:hover,
pre.code a:focus {
  opacity: 0.85;
  text-decoration: underline;
}

pre.code .tok-str a,
pre.code .tok-comment a {
  color: inherit;
  text-decoration: underline;
}

/* Agent panel internals */
.agent .header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px
}

.agent .avatar {
  width: 36px;
  height: 36px;
  border-radius: 6px;
  background: linear-gradient(135deg, var(--accent-5), var(--accent-6));
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 700
}

.chat-area {
  flex: 0 0 auto;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 10px 24px 70px 10px;
  border-radius: 8px;
  background: var(--code-bg);
  display: flex;
  flex-direction: column;
  gap: 8px;
  scrollbar-gutter: stable both-edges;
  min-height: 220px
}

.chat-area::-webkit-scrollbar {
  width: 6px
}

.chat-area::-webkit-scrollbar-track {
  background: transparent
}

.chat-area::-webkit-scrollbar-thumb {
  background: transparent;
  border-radius: 99px;
  transition: background 200ms ease, opacity 200ms ease
}

.chat-area:hover::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.08), rgba(0, 0, 0, 0.12))
}

.dark .chat-area:hover::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.10))
}

.chat-area::-webkit-scrollbar-corner {
  background: transparent
}

.dark .chat-area::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.10))
}

.chat-area {
  scrollbar-color: rgba(0, 0, 0, 0.12) transparent
}

.dark .chat-area {
  scrollbar-color: rgba(255, 255, 255, 0.10) transparent
}

.bubbles {
  display: flex;
  flex-direction: column;
  gap: 8px
}

.faq-btn {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 8px;
  padding: 10px 12px;
  border-radius: 10px;
  background: transparent;
  border: 1px solid rgba(0, 0, 0, 0.04);
  cursor: pointer;
  text-align: left
}

.faq-btn:hover {
  background: linear-gradient(180deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.01));
  border-color: var(--glass)
}

.dark .faq-btn {
  border-color: rgba(255, 255, 255, 0.04)
}

.faq-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06)
}

.faq-icon {
  width: 28px;
  height: 28px;
  border-radius: 8px;
  background: linear-gradient(135deg, var(--accent-5), var(--accent-6));
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-weight: 700
}

.typing-dots {
  display: inline-flex;
  gap: 6px;
  align-items: center;
  padding: 6px
}

.typing-dots span {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #fff;
  opacity: 0.85;
  animation: typing 1s infinite
}

@keyframes typing {
  0% {
    transform: translateY(0);
    opacity: 0.25
  }

  50% {
    transform: translateY(-4px);
    opacity: 1
  }

  100% {
    transform: translateY(0);
    opacity: 0.25
  }
}

.agent {
  position: relative
}

.faq-wrapper {
  position: absolute;
  right: 32px;
  bottom: 32px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 8px;
  z-index: 120
}

.faq-toggle {
  width: 44px;
  height: 44px;
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.04);
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02));
  color: var(--text);
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  box-shadow: 0 6px 18px rgba(10, 10, 20, 0.06);
  transition: transform 180ms ease, background 220ms ease, color 220ms ease
}

.faq-toggle::before {
  content: '+';
  font-weight: 700;
  display: block
}

.faq-toggle.open {
  transform: scale(1.03);
  background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
  color: #fff
}

.faq-toggle:hover {
  transform: translateY(-4px)
}

.faq-toggle.open {
  transform: rotate(45deg) scale(1.03)
}

.faq-list {
  position: absolute;
  right: 12px;
  bottom: 64px;
  width: 320px;
  overflow: auto;
  background: var(--panel);
  border-radius: 10px;
  padding: 10px;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 220ms ease, transform 220ms ease, visibility 220ms;
  pointer-events: none
}

.faq-list[hidden] {
  opacity: 0;
  pointer-events: none;
  visibility: hidden
}

.msg {
  position: relative;
  max-width: 80%;
  padding: 12px 12px;
  border-radius: 14px;
  font-size: 14px;
  line-height: 1.25;
  display: inline-block;
  box-shadow: 0 8px 24px rgba(10, 10, 20, 0.06);
  transition: all 240ms ease
}

.msg.user {
  align-self: flex-end;
  background: var(--user-grad);
  color: #fff;
  border-bottom-right-radius: 6px
}

.msg.user::after {
  content: '';
  position: absolute;
  width: 14px;
  height: 14px;
  right: -6px;
  bottom: 8px;
  background: var(--user-color);
  transform: rotate(45deg);
  border-radius: 0;
  box-shadow: 0 8px 18px rgba(10, 10, 20, 0.06)
}

.dark .msg.user::after {
  background: var(--user-color-dark)
}

.msg.ai {
  align-self: flex-start;
  background: var(--ai-grad);
  color: #fff;
  border-bottom-left-radius: 6px
}

.dark .msg.ai {
  background: var(--ai-grad-dark)
}

.msg.ai::after {
  content: '';
  position: absolute;
  width: 14px;
  height: 14px;
  left: -6px;
  bottom: 8px;
  background: var(--ai-color);
  transform: rotate(45deg);
  border-radius: 0;
  box-shadow: 0 8px 18px rgba(10, 10, 20, 0.06)
}

.dark .msg.ai::after {
  background: var(--ai-color-dark)
}

.faq-list:not([hidden]) {
  opacity: 1;
  transform: none;
  pointer-events: auto;
  visibility: visible
}

.msg a {
  color: inherit;
  text-decoration: underline;
  text-underline-offset: 2px;
  transition: opacity 0.2s;
}

.msg a:hover,
.msg a:focus {
  opacity: 0.8;
}

footer {
  grid-column: 1/-1;
  text-align: center;
  color: var(--muted);
  font-size: 14px
}

footer a {
  color: inherit;
  text-decoration: none
}

@media (max-width:980px) {
  .container {
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr auto
  }

  .frame {
    grid-column: 1
  }

  .frame {
    grid-template-columns: 1fr
  }

  .chat-area {
    padding: 10px 24px 140px 24px
  }
}